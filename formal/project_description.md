# Проект

## Введение

**Цели работы:**
1. Отработка навыков проектирования.
2. Знакомство с DDL-операторами на примере собственной БД.
3. Применение изученных средств языка SQL на самостоятельно спроектированной БД.

Проект является обязательной оцениваемой активностью на курсе. В соответствии с [системой оценивания](https://github.com/destitutiones/hsse-db-2024/blob/main/formal/evaluation_system.md) за проект необходимо набрать не менее 1 балла.

## Проверка

- Задание по проектированию проверяется семинаристами, дедлайны каждой итерации согласовываются с ними же.
- Проверка домашнего задания ручная, а потому не мгновенная.
- Чем раньше до дедлайна происходит отправка **содержательной** части домашнего задания, тем больше времени на внесение правок.


## Постановка

1. Выбрать предметную область, выделить в ней 4-6 сущностей, согласовать с семинаристом.
2. Спроектировать базу данных:
   1. **Концептуальная модель**: все сущности из п.1 с указанием связей в нотации «воронья лапка». 
   2. **Логическая модель**: описание таблиц и их атрибутивного состава, а также указание связей в нотации «воронья 
   лапка». БД должна находиться во 2НФ или в 3НФ, должны отсутствовать связи «многие ко многим».
   Для описания использовать ER-диаграмму.
   3. **Физическая модель**: DDL-скрипты по созданию спроектированной БД с учетом всех необходимых ограничений. В случае недостаточно понятных названий полей предпочтительно добавлять комментарии с пояснениями. Для разнообразия предлагается часть ограничений задавать в самом `CREATE`-запросе, а некоторые – с использованием `ALTER`. 
3. Наполнить созданную базу данными с использованием оператора `INSERT` (не через UI в DataGrip, т.к. ваши скрипты будут запускаться в CI для проверки корректности). В итоге в каждой таблице ожидается не менее 10 записей.
4. Написать не менее 5 `UPDATE`, `DELETE` запросов в сумме.
5. Написать несколько `SELECT`-запросов:
   1. Не менее 5 запросов с использованием `WHERE`, `GROUP BY`, `HAVING`.
   2. Не менее 5 запросов с использованием оконных функций (предпочтительно разных видов – агрегирующих, ранжирующих, смещения).
6. Написать не менее 4 представлений (view). Примеры: сокрытие полей с персональными данными клиентов из таблицы (например, для поля CARD_NO можно использовать маскировку вида 4276********0000), сокрытие технических полей, результат соединения нескольких таблиц с целью получения осмысленной сводной таблицы, например, хранящей некоторую статистику продаж/частот, обращения клиента и т.д.
7. Создать не менее 4 **осмысленных** хранимых процедур/функций/триггеров. Логику можно предварительно обсудить с семинаристом.
8. **(bonus)** Создать индексы для таблиц (для которых это целесообразно), **аргументировав выбор поля, по которому будет создан индекс**
9. **(bonus)** Отработать создание, наполнение и работу с БД с использованием предпочитаемой ORM (желательно с использованием Python) - написать тесты к реализованным пунктам

_Примечания:_
1. Проект итеративный, потому нельзя получить баллы за написание запросов (пункты 3 и далее), миновав этап проектирования.
2. Каждый этап задания, предполагающий написание запросов, подразумевает наличие комментариев, проясняющих содержание запроса.

### Оценивание
| Задание | Балл        | Дедлайн          | Примечание                                                      |
|---------|-------------|------------------|-----------------------------------------------------------------|
| `1`     | `0`         | -                |  Является стартовой точкой вашего проекта                       |
| `2.1`   | `0.2`       | -                |                                                                 | 
| `2.2`   | `0.2`       | -                |                                                                 |
| `2.3`   | `0.2`       | -                |                                                                 |
| `3`     | `0.4`       | 22.04            |                                                                 |
| `4`     | `0.4`       | 29.04            | По 0.08 за каждый запрос                                        |
| `5`     | `0.5`       | 29.04            | По `0.05` за каждый осмысленный запрос                          |
| `6`     | `0.5`       | 06.05            | По `0.125` за каждое осмысленное view                           |
| `7`     | `0.6`       | 06.05            | По `0.15` за каждую процедуру/функцию/триггер                   |
| `8`     | `0.3`       | 11.05            | **Бонус**, необходимо обосновать каждый созданный индекс        |
| `9`     | `0.7`       | 11.05            | **Бонус**, язык программирования может быть любой               |

### Оформление

**Концептуальная и логическая модель**

Схемы, нарисованные на бумаге или планшете от руки не принимаются. Некоторые варианты сервисов, где можно составить схему БД:
- [lucidchart](http://www.lucidchart.com/) — есть все нужные связи и выглядит приятно, но есть лимит на количество объектов в схеме (около 20, чего для проекта должно хватить).
- [drawio](https://app.diagrams.net/) — отсутствует ограничение на количество элементов в схеме.

В обоих представленных вариантах нужные объекты лучше искать по комбинации "entity relation".

**Написание запросов**

- Все запросы должны быть воспроизводимыми, итерация с нерабочими SQL-скриптами не засчитывается.
- Чуть позже здесь же появится ссылка на репозиторий-пример с заполненным `.gitlab-ci.yml`, чтобы вы могли настроить запуск sql-скриптов в рамках CI.

## Оценивание

- Итоговый балл за проект не может превышать 3.
- За итерацию можно получить неполный балл.
- Оценивание итерации, засланной после дедлайна, согласовывается с семинаристом.

## Примеры тем работ

<details>
  <summary>Примеры</summary>

Основано на работах прошлых лет. Базы данных:
1. Аптечной сети
2. Психологического диспансера
3. Книжного магазина
4. Компании авиаперевозок
5. Банкетного зала
6. Цирка
7. Службы доставки магазина
8. Хоккеистов из NHL
9. Профессионального киберспорта
10. Вебсайта гольфклуба
11. Сайта для брони авиабилетов
12. Кофейни
13. Интернет-магазина приложений
14. Музыкального приложения по типу Apple Music
15. Банка

</details>
