# Материалы

- [Лекция 4](https://drive.google.com/file/d/1fDmQ2LPY21pUXBQDRxYpmCh-ATXeu7sV/view?usp=sharing)
- [Туториал](https://www.tutorialsteacher.com/postgresql/identity-column) по identity-column.

# Теория

## Проектирование

### Основные этапы проектирования

Рассматриваем на примере проектирования БД гитарного магазина.

#### Концептуальное проектирование

1. Определяем предметную область, с которой будем работать. Например, предметная область ритейла.
2. Разбиваем на не детализированные сущности. Например, чек покупки, продукт, магазин, ассортиментная матрица и т.д.
3. Определяем, как сущности будут друг с другом связаны: один к одному, один ко многим и т.д.
4. Строим визуальную картину в ER-нотации "Воронья лапка" (Crow's Foot) _без явных атрибутов_.

**Пример результата:**

<img src='./img/img0_concept.png' width='700'>

#### Логическое проектирование

1. Разбиваем сущности из этапа концептуального проектирования на детализированные согласно выбранной модели данных и нормализации.
2. Определяем атрибуты, связи между сущностями по атрибутам.
3. Строим визуальную картину в ER-нотации "Воронья лапка" (Crow's Foot) _с явными атрибутами_.

**Пример результата:**

<img src='./img/img1_logical.png' width='700'>

#### Физическое проектирование

1. Создаем логическую схему базы данных для конкретной СУБД.
2. Учитываем возможные ограничения на именование объектов базы данных, поддерживаемые типы данных и т.п.
3. Пишем SQL-скрипт с созданием таблиц с учётом всех заявленных ограничений или детальную таблицу-образец для дальнейшего написания скриптов.

**Пример результата в виде таблицы:**

*Note.* Вместо `VARCHAR(255)` предпочтительнее использовать `TEXT`, а вместо `SERIAL` – `identity-column` (см. материалы в самом начале).

<img src='./img/img2_physical.png' width='700'>

### Нотация "Воронья лапка"

* Сущность изображается в виде прямоугольника, содержащего ее имя.
* Атрибуты сущности (для логической модели) записываются внутри прямоугольника, изображающего сущность.
* Связь изображается линией, которая соединяет две сущности, участвующие в отношении.
* Описания связей выглядят следующим образом:

<img src='./img/img3_er_notation.png' width='700'>

### Нормализация

**Нормализацией БД** называют приведение БД к нормальной форме.

**Нормальная форма**:
- совокупность требований, которым должно удовлетворять отношение для уменьшения вероятности возникновения аномалий;
- свойство отношения в реляционной модели данных, характеризующее его с точки зрения избыточности, потенциально приводящей к логически ошибочным результатам выборки или изменениям данных.

**Для чего нормализация предназначена:**

- Минимизация логической избыточности.
- Уменьшение потенциальной противоречивости.
- Исключение некоторых типов избыточности.
- Устранение некоторых аномалий обновления.

**Для чего нормализация не предназначена:**
- Уменьшение/увеличение производительности или физического объема БД.

#### Определения

- *Декомпозиция* – разложение исходной переменной отношения на несколько эквивалентных. Обратимая декомпозиция называется *декомпозицией без потерь* или *правильной*. 
- *Аномалия* – ситуация в таблице БД, которая приводит к противоречию в БД либо существенно усложняет обработку БД. Причиной является излишнее дублирование данных в таблице, которое вызывается наличием функциональных зависимостей от не ключевых атрибутов. 
- *Функциональная зависимость* между множествами атрибутов **A** и **B** означает, что для любого допустимого набора кортежей в данном отношении верно следующее: если два кортежа совпадают по значению **A**, то они совпадают по значению **B**.
- *Минимальная функциональная зависимость* означает, что в составе первичного ключа отсутствует меньшее подмножество атрибутов, от которого можно также вывести данную функциональную зависимость.

#### Нормальная форма 1 (1НФ)

#### Нормальная форма 2 (2НФ)

#### Нормальная форма 3 (3НФ)


# Практика

## Работа на семинаре
